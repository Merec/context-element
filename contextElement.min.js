(function(d){var b="[data-toggle=contextElement]";var c=function(g,f){var h=this;this.element=d(g);this.options=d.extend({},c.DEFAULTS,f);if(this.element.attr("data-target")){this.options.target=d(this.element.attr("data-target"))}if(this.element.attr("data-source")){this.options.target=d(this.element.attr("data-source"))}if(this.element.attr("data-sourceLoadingText")){this.options.target=d(this.element.attr("data-source"))}if(this.element.attr("data-displayTimeout")){this.options.displayTimeout=parseInt(this.element.attr("data-displayTimeout"))}if(this.element.attr("data-mouseOutTimeout")){this.options.mouseOutTimeout=parseInt(this.element.attr("data-mouseOutTimeout"))}if(this.element.attr("data-modal")){this.options.cursorMargin=!!(d.inArray([true,1,"on","true"],this.element.attr("data-modal"))!==false)}if(this.element.attr("data-cursorMargin")){this.options.cursorMargin=parseInt(this.element.attr("data-cursorMargin"))}if(this.element.attr("data-leftClick")){this.options.leftClick=!!(d.inArray([true,1,"on","true"],this.element.attr("data-leftClick"))!==false)}if(this.element.attr("data-middleClick")){this.options.middleClick=!!(d.inArray([true,1,"on","true"],this.element.attr("data-middleClick"))!==false)}if(this.element.attr("data-rightClick")){this.options.rightClick=!!(d.inArray([true,1,"on","true"],this.element.attr("data-rightClick"))!==false)}if(this.element.attr("data-effect")){this.options.effect=this.element.attr("data-effect")}if(this.element.attr("data-effectDuration")){this.options.effectDuration=parseInt(this.element.attr("data-effectDuration"))}if(this.options.modal){this.options.displayTimeout=0;this.options.mouseOutTimeout=0}this.debug=false;this.debugOnlyConsole=true;this.target=null;this.targetPrepared=false;this.sourceIsLoading=false;this.gotTargetFromSource=false;this.displayContextElement=false;this.isTouchDevice="ontouchstart" in document.documentElement;this.displayTimeoutTimer=null;this.mouseOutTimeoutTimer=null;this.touchDisplayContextElementTimer=true;if(this.options.rightClick){this.element.on("contextmenu",function(i){i.preventDefault()})}};c.DEFAULTS={target:null,source:null,sourceLoadingText:"Loading ...",displayTimeout:2500,mouseOutTimeout:300,modal:false,cursorMargin:5,leftClick:false,middleClick:false,rightClick:true,effect:"fade",effectDuration:150,touch:{cursorMargin:20,displayAfterTime:500,displayTimeout:0},ajax:{},events:{beforeDisplay:"beforeDisplay.bs.contextElement",onDisplay:"onDisplay.bs.contextElement",beforeHide:"beforeHide.bs.contextElement",onHidden:"onHidden.bs.contextElement",sourceLoading:"sourceLoading.bs.contextElement",sourceLoaded:"sourceLoaded.bs.contextElement"}};c.prototype.debugMessage=function(f){if(!this.debug){return}if(!this.debugOnlyConsole){this.element.html(this.element.html()+f+"<br />")}console.log(f)};c.prototype.prepareTarget=function(j){if(this.targetPrepared){return true}var i=this;if(this.options.source){if(typeof this.options.source=="string"&&!this.gotTargetFromSource){if(this.sourceIsLoading){return false}if(this.target){this.target.remove();this.target=null}this.sourceIsLoading=true;var h=(typeof this.options.sourceLoadingText=="function ")?this.options.sourceLoadingText():this.options.sourceLoadingText;if(h){var g=this.options.displayTimeout;var f=this.options.touch.displayTimeout;this.options.displayTimeout=0;this.target=d('<div style="position: absolute; display: none;"></div>').html(h);d(document.body).append(this.target);this.display()}this.element.trigger(this.options.events.sourceLoading);d.ajax(this.options.source,this.options.ajax).done(function(k){if(i.target){i.target.remove();i.target=null;i.options.displayTimeout=g;i.options.touch.displayTimeout=f;i.targetIsSourceLoading=false}i.target=d(k);i.gotTargetFromSource=true;i.sourceIsLoading=false;i.element.trigger(i.options.events.sourceLoaded);i.show(j)});return false}if(this.gotTargetFromSource){this.gotTargetFromSource=false}}else{this.target=d(this.options.target)}this.target.css({position:"absolute",display:"none"});d(document.body).append(this.target);this.target.hover(function(){if(i.displayTimeoutTimer!=null){window.clearTimeout(i.displayTimeoutTimer);i.displayTimeoutTimer=null}if(i.mouseOutTimeoutTimer!=null){window.clearTimeout(i.mouseOutTimeoutTimer);i.mouseOutTimeoutTimer=null}},function(){if(i.options.mouseOutTimeout>0){i.mouseOutTimeoutTimer=window.setTimeout(function(){i.element.contextElement("hide")},i.options.mouseOutTimeout)}});if(!this.options.source){this.targetPrepared=true}return true};c.prototype.show=function(g){var f=this;if(this.isTouchDevice){this.showTouch(g);return}if(g.type=="mousedown"){if(g.which==1&&!this.options.leftClick){return}if(g.which==2&&!this.options.middleClick){return}if(g.which==3&&!this.options.rightClick){return}this.displayContextElement=true;return}if(!this.displayContextElement){return}this.lastPointsToDisplayAt={x:g.pageX,y:g.pageY};if(!this.prepareTarget(g)){return}this.displayContextElement=false;this.display()};c.prototype.showTouch=function(g){var f=this;if(g.type=="touchstart"){this.lastPointsToDisplayAt={x:g.originalEvent.touches[0].pageX,y:g.originalEvent.touches[0].pageY};if(this.options.touch.displayAfterTime){this.touchDisplayContextElementTimer=window.setTimeout(function(){f.displayContextElement=true;f.touchDisplayContextElementTimer=null},this.options.touch.displayAfterTime);return}}if(this.touchDisplayContextElementTimer!=null){window.clearTimeout(this.touchDisplayContextElementTimer);this.touchDisplayContextElementTimer=null}if(!this.displayContextElement){return}this.displayContextElement=false;this.display()};c.prototype.touchmove=function(f){if(this.touchDisplayContextElementTimer!=null){window.clearTimeout(this.touchDisplayContextElementTimer);this.touchDisplayContextElementTimer=null}};c.prototype.display=function(f,k){if(!f&&this.lastPointsToDisplayAt.x){f=this.lastPointsToDisplayAt.x}else{throw"No position X given"}if(!k&&this.lastPointsToDisplayAt.y){k=this.lastPointsToDisplayAt.y}else{throw"No position Y given"}var i=this;if(!this.target||this.target.length==0){return}if(!this.sourceIsLoading){this.element.trigger(this.options.events.beforeDisplay)}var g=(this.isTouchDevice)?this.options.touch.cursorMargin:this.options.cursorMargin;this.target.css({left:f+g,top:k+g});if(this.options.effect=="slide"){this.target.finish().slideDown(this.options.effectDuration)}else{if(this.options.effect=="fade"){this.target.finish().fadeIn(this.options.effectDuration)}else{this.target.finish().show()}}var j=f+this.target.outerWidth()+g;if(d(window).innerWidth()<j){this.target.css("left",f-this.target.outerWidth()-g)}var h=k+this.target.outerHeight()+g;if(d(window).innerHeight()+d(window).scrollTop()<h){this.target.css("top",k-this.target.outerHeight()-g)}if(!this.sourceIsLoading){this.element.trigger(this.options.events.onDisplay)}if(this.isTouchDevice){if(this.options.touch.displayTimeout>0){this.displayTimeoutTimer=window.setTimeout(function(){i.hide()},this.options.touch.displayTimeout)}}else{if(this.options.displayTimeout>0){this.displayTimeoutTimer=window.setTimeout(function(){i.hide()},this.options.displayTimeout)}}};c.prototype.hide=function(){if(!this.target||!this.target.is(":visible")){return}this.element.trigger(this.options.events.beforeHide);if(this.options.effect=="slide"){this.target.stop().slideUp(this.options.effectDuration)}else{if(this.options.effect=="fade"){this.target.stop().fadeOut(this.options.effectDuration)}else{this.target.stop().hide()}}if(this.displayTimeoutTimer!=null){window.clearTimeout(this.displayTimeoutTimer);this.displayTimeoutTimer=null}if(this.mouseOutTimeoutTimer!=null){window.clearTimeout(this.mouseOutTimeoutTimer);this.mouseOutTimeoutTimer=null}this.element.trigger(this.options.events.onHidden)};c.prototype.hideIfNotModal=function(){if(!this.options.modal){this.hide()}};function e(f){d(b).each(function(){d(this).contextElement("hideIfNotModal",f)})}var a=d.fn.contextElement;d.fn.contextElement=function(f,g){return this.each(function(){var j=d(this);var i=j.data("bs.contextElement");var h=d.extend({},c.DEFAULTS,j.data(),typeof f=="object"&&f);if(!i){j.data("bs.contextElement",(i=new c(this,h)))}if(typeof f=="string"){i[f](g)}if(!g){j.on("mousedown.bs.contextElement.data-api",function(k){d(this).contextElement("show",k)}).on("mouseup.bs.contextElement.data-api",function(k){d(this).contextElement("show",k)})}})};d.fn.contextElement.Constructor=c;d.fn.contextElement.noConflict=function(){d.fn.contextElement=a;return this};d(document).on("mousedown.bs.contextElement.data-api",e).on("mousedown.bs.contextElement.data-api",b,function(f){d(this).contextElement("show",f)}).on("mouseup.bs.contextElement.data-api",b,function(f){d(this).contextElement("show",f)}).on("touchstart.bs.contextElement.data-api",b,function(f){d(this).contextElement("show",f)}).on("touchend.bs.contextElement.data-api",b,function(f){d(this).contextElement("show",f)}).on("touchmove.bs.contextElement.data-api",b,function(f){d(this).contextElement("touchmove",f)})})(window.jQuery);